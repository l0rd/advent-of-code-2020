apiVersion: 1.0.0
metadata:
  generateName: aoc2020
components:
  - alias: tools
    type: dockerimage
    image: quay.io/che-incubator/advent-of-code-2020:latest
    memoryLimit: 512Mi
    mountSources: true
  - alias: go-plugin
    type: chePlugin
    id: golang/go/latest
    memoryLimit: 512Mi
    preferences:
      go.lintTool: golangci-lint
      go.useLanguageServer: true
      go.lintFlags: '--fast'
    env:
      - value: auto
        name: GO111MODULE
  - type: chePlugin
    reference: 'https://gist.githubusercontent.com/sunix/eb86fdf6802afbfb4de059ed19f08d37/raw/41515915211723ca3c740d28263d7b8a87e0a8b6/meta.yaml'
commands:
  - name: day-01-solution
    actions:
      - type: exec
        component: tools
        workdir: '${CHE_PROJECTS_ROOT}/advent-of-code-2020/day-01'
        command: go run day-01.go
  - name: day-02-solution
    actions:
      - type: exec
        component: tools
        workdir: '${CHE_PROJECTS_ROOT}/advent-of-code-2020/day-02'
        command: go run day-02.go
  - name: day-03-solution
    actions:
      - type: exec
        component: tools
        workdir: '${CHE_PROJECTS_ROOT}/advent-of-code-2020/day-03'
        command: go run day-03.go
  - name: day-04-solution-rust
    actions:
      - type: exec
        component: tools
        workdir: '${CHE_PROJECTS_ROOT}/advent-of-code-2020/day-04'
        command: rustc day-04.rs && ./day-04 && rm ./day-04
